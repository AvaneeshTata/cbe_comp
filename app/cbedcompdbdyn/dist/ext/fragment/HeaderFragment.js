sap.ui.define(["sap/m/MessageToast","sap/ui/export/Spreadsheet","sap/ui/model/json/JSONModel","sap/ui/export/library"],function(e,t,g,s){"use strict";var n=s.EdmType;return{onRowExpand:function(e){if(e.getSource().getPressed()==true){e.getSource().setText("ItemList-CollapseAll");let t=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon1");if(t.getSrc()=="sap-icon://navigation-right-arrow"){t.firePress()}let g=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon2");if(g.getSrc()=="sap-icon://navigation-right-arrow"){g.firePress()}let s=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon3");if(s.getSrc()=="sap-icon://navigation-right-arrow"){s.firePress()}}else{e.getSource().setText("ItemList-ExpandAll");let t=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon1");if(t.getSrc()=="sap-icon://navigation-up-arrow"){t.firePress()}let g=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon2");if(g.getSrc()=="sap-icon://navigation-up-arrow"){g.firePress()}let s=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon3");if(s.getSrc()=="sap-icon://navigation-down-arrow"){s.firePress()}}},onColumnExpand:function(e){var t=e.getSource().getParent().getParent().getParent().getParent().getParent().getSections()[0].getSubSections()[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1].mAggregations.content[0].mAggregations.items;var g=e.getSource().getParent().getParent().getParent().getParent().getParent().getSections()[0].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[0].mAggregations.items[1].mAggregations.items[0].mAggregations.items[1];if(e.getSource().getPressed()==true){e.getSource().setText("VendorList-CollapseAll");if(g.getSrc()=="sap-icon://expand"){g.firePress()}for(let e=0;e<t.length;e++){let g=t[0].getItems()[1].getItems().length;var s=t[e].getItems()[1].getItems()[g-1].mAggregations.items[1].mAggregations.items[1].mAggregations.columns[2].mAggregations.header.mAggregations.items[1];if(s.getSrc()=="sap-icon://expand"){s.firePress()}}}else{e.getSource().setText("VendorList-ExpandAll");if(g.getSrc()=="sap-icon://collapse"){g.firePress()}for(let e=0;e<t.length;e++){let g=t[0].getItems()[1].getItems().length;var s=t[e].getItems()[1].getItems()[g-1].mAggregations.items[1].mAggregations.items[1].mAggregations.columns[2].mAggregations.header.mAggregations.items[1];if(s.getSrc()=="sap-icon://collapse"){s.firePress()}}}},onExportExcel:async function(t){var g=[];var s=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--mainhbox1");let o=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--projectvalue").getText();let r=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--itemstable1");let a=[];for(let e=0;e<r.getItems().length;e++){a.push({mta_no:e+1,item_desc:r.getItems()[e].getCells()[0].getText(),tag_no:r.getItems()[e].getCells()[1].getText(),types_of_vessel:r.getItems()[e].getCells()[2].getText(),cap_each:r.getItems()[e].getCells()[3].getText(),dia:r.getItems()[e].getCells()[4].getText(),tl_tl:r.getItems()[e].getCells()[5].getText(),moc:r.getItems()[e].getCells()[6].getText(),dpb:r.getItems()[e].getCells()[7].getText(),weights:r.getItems()[e].getCells()[8].getText(),quantity:r.getItems()[e].getCells()[9].getText()})}var g=[{1:"Commercial Bid Evaluation"},{1:"",2:"",11:"Supplier"},{1:"",2:"",11:"Location"},{1:"Project",2:o,9:" ",11:"Qtn. Ref."},{1:"",2:"",11:"Date"},{1:"",2:"",11:"Validity"},{1:"",2:"",6:"Cylindrical Data"},{1:"MTO Sr.NO ",2:"Items Description",3:"Tag No",4:"Type of Vessel",5:"Capacity Each ( Cu Mtr )",6:"Dia mm",7:"TL to TL Length (mm)",8:"MOC",9:"Design Pressure bar",10:"Weights",11:"Quantity"}];for(let e=0;e<a.length;e++){g.push({1:a[e].mta_no,2:a[e].item_desc,3:a[e].tag_no,4:a[e].types_of_vessel,5:a[e].cap_each,6:a[e].dia,7:a[e].tl_tl,8:a[e].moc,9:a[e].dpb,10:a[e].weights,11:a[e].quantity})}var i=[{1:"",2:""},{1:"3",2:"Spares for 2 Years operation"},{1:" ",2:"Grand Total"},{1:"4",2:"Packing, Marking, Forwarding & Freight"},{1:"5",2:"Inspection / Testing Charges"},{1:"B.3",2:"Documentation Charges"},{1:"3",2:"Total Basic Price including packing, marking & forwarding"},{1:"C",2:"RNOD"},{1:"D.1",2:"Custom Duty & Cess"},{1:"D.2",2:"SGST"},{1:"D.3",2:"IGST"},{1:"D.4",2:"UGST"},{1:"D.6",2:"Shipment charges from EXW to ISRO Mahendragiri"},{1:"D",2:"Total Basic Price including packing, marking & forwarding, Transportation including Taxes"},{2:"Total Basic Price including packing, marking & forwarding, Transportation excluding Taxes"},{1:"F",2:"Per Diem rate for Supervision for Erection and commissioning"},{1:"G.1",2:"PriceBasic"},{1:"G.2",2:"Point of delivery"},{1:"G.3",2:"Delivery Period"},{1:"G.4",2:"Payment Terms"},{1:"G.5",2:"Liquidated Damages"},{1:"G.6",2:"Warranty / Defect Liability Period"},{1:"G.7",2:"CPBG"},{1:"G.9",2:"Contact person"},{1:"G.10",2:"Contact No"},{1:"G.11",2:"Order can be given to .."},{1:"G.12",2:"Technical approved"},{1:"G.13",2:"Approved vendor"}];var l=g.concat(i);var c=[];var m=s.getItems()[1].getContent()[0].getItems();let p=[];let d=[];let u=12;for(let e=0;e<m.length;e++){let t=m[e].getItems()[0].getItems()[0].getText();let g=m[e].getItems()[0].getItems()[1].getText();let s=m[e].getItems()[1].getItems();let n=[];p=[{[u]:""},{[u]:t},{[u]:g}];let o=[];let r=m[e].getItems()[2].getItems()[1].getItems();for(let e=0;e<s.length;e++){let t=s[e].getItems()[0].getItems()[0].getText();let g=s[e].getItems()[0].getItems()[1].getText();let n=s[e].getItems()[0].getItems()[2].getText();let i=s[e].getItems()[1].getItems()[0].getText();let l=u;let c=u+1;let m=u+2;u=u+3;let p=[{[l]:t},{[l]:g},{[l]:n},{[c]:i},{[l]:"Unit Rate",[c]:"Rate per unit",[m]:"Total Amount"}];for(let t=0;t<a.length;t++){p.push({[l]:s[e].getItems()[1].getItems()[1].getItems()[t].getCells()[0].getText(),[c]:s[e].getItems()[1].getItems()[1].getItems()[t].getCells()[1].getText(),[m]:s[e].getItems()[1].getItems()[1].getItems()[t].getCells()[2].getText()})}let d=s[e].getItems()[1].getItems()[1].getItems();let T=a.length;let x=[{[l]:""},{[m]:d[T+1].getCells()[2].getText()},{[m]:d[T+2].getCells()[2].getText()},{[l]:d[T+3].getCells()[0].getText(),[m]:d[T+3].getCells()[2].getText()},{[l]:d[T+4].getCells()[0].getText(),[m]:d[T+4].getCells()[2].getText()},{[l]:d[T+5].getCells()[0].getText(),[m]:d[T+5].getCells()[2].getText()},{[m]:d[T+6].getCells()[2].getText()},{[m]:d[T+7].getCells()[2].getText()},{[l]:d[T+8].getCells()[0].getText()},{[l]:d[T+9].getCells()[0].getText(),[m]:d[T+9].getCells()[2].getText()},{[l]:d[T+10].getCells()[0].getText(),[m]:d[T+10].getCells()[2].getText()},{[l]:d[T+11].getCells()[0].getText(),[m]:d[T+11].getCells()[2].getText()},{[l]:d[T+12].getCells()[0].getText()},{[m]:d[T+13].getCells()[2].getText()},{[m]:d[T+14].getCells()[2].getText()},{[m]:d[T+15].getCells()[2].getText()},{[l]:r[e].getItems()[0].getText()},{[l]:r[e].getItems()[1].getText()},{[l]:r[e].getItems()[2].getContent()[0].getText()},{[l]:r[e].getItems()[3].getContent()[0].getText()},{[l]:r[e].getItems()[4].getContent()[0].getText()},{[l]:r[e].getItems()[5].getContent()[0].getText()},{[l]:r[e].getItems()[6].getContent()[0].getText()},{[l]:r[e].getItems()[7].getText()},{[l]:r[e].getItems()[8].getText()},{[l]:r[e].getItems()[9].getText()},{[l]:r[e].getItems()[10].getText()},{[l]:r[e].getItems()[11].getText()}];p=p.concat(x);o.push(p)}const i=o.map(e=>e.length);const l=i.every((e,t,g)=>e===g[0]);let c=[];if(l){for(let e=0;e<o[0].length;e++){let t={};for(let g=0;g<o.length;g++){Object.assign(t,o[g][e])}c.push(t)}console.log(c)}else{console.log("Arrays in updatarr have different lengths. Unable to merge.")}p=p.concat(c);d.push(p)}let T=[];const x=d.map(e=>e.length);const I=x.every((e,t,g)=>e===g[0]);if(I){for(let e=0;e<d[0].length;e++){let t={};for(let g=0;g<d.length;g++){Object.assign(t,d[g][e])}T.push(t)}console.log(T)}else{console.log("Arrays in updatarr have different lengths. Unable to merge.")}console.log(T);let f=[];if(l.length===T.length){for(let e=0;e<l.length;e++){let t=Object.assign({},l[e],T[e]);f.push(t)}console.log(f)}else{console.log("Arrays have different lengths. Unable to merge.")}let C=[];for(let e=0;e<u;e++){if(u==1){C.push({label:` `,property:`${e+1}`,type:n.String,width:"100"})}else{C.push({label:` `,property:`${e+1}`,type:n.String})}}debugger;debugger;var b=new sap.ui.export.Spreadsheet({workbook:{columns:C,context:{application:"SAP UI5 Export Sample",author:"Sample"},hierarchyLevel:"level"},dataSource:f,fileName:"cbe_comp.xlsx"});b.build().then(function(){e.show("Exported successfully!")}).catch(function(t){e.show("Export failed: "+t)})}}});