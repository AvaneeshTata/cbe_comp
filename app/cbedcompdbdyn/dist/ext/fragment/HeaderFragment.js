sap.ui.define(["sap/m/MessageToast","sap/ui/export/Spreadsheet","sap/ui/model/json/JSONModel","sap/ui/export/library"],function(e,t,g,s){"use strict";var o=s.EdmType;return{onRowExpand:function(e){if(e.getSource().getPressed()==true){debugger;e.getSource().setText("ItemList-CollapseAll");let t=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon2");if(t.getSrc()=="sap-icon://navigation-right-arrow"){t.firePress()}let g=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon3");if(g.getSrc()=="sap-icon://navigation-right-arrow"){g.firePress()}}else{e.getSource().setText("ItemList-ExpandAll");let t=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon2");if(t.getSrc()=="sap-icon://navigation-up-arrow"){t.firePress()}let g=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--icon3");if(g.getSrc()=="sap-icon://navigation-down-arrow"){g.firePress()}}},onColumnExpand:function(e){var t=e.getSource().getParent().getParent().getParent().getParent().getParent().getSections()[0].getSubSections()[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[1].mAggregations.content[0].mAggregations.items;var g=e.getSource().getParent().getParent().getParent().getParent().getParent().getSections()[0].mAggregations._grid.mAggregations.content[0].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[0].mAggregations.items[1].mAggregations.items[0].mAggregations.items[1];if(e.getSource().getPressed()==true){e.getSource().setText("VendorList-CollapseAll");if(g.getSrc()=="sap-icon://expand"){g.firePress()}for(let e=0;e<t.length;e++){let g=t[0].getItems()[1].getItems().length;debugger;var s=t[e].getItems()[1].getItems()[g-1].mAggregations.items[1].mAggregations.items[1].mAggregations.columns[1].mAggregations.header.mAggregations.items[1];if(s.getSrc()=="sap-icon://expand"){s.firePress()}}}else{e.getSource().setText("VendorList-ExpandAll");if(g.getSrc()=="sap-icon://collapse"){g.firePress()}for(let e=0;e<t.length;e++){let g=t[0].getItems()[1].getItems().length;var s=t[e].getItems()[1].getItems()[g-1].mAggregations.items[1].mAggregations.items[1].mAggregations.columns[1].mAggregations.header.mAggregations.items[1];if(s.getSrc()=="sap-icon://collapse"){s.firePress()}}}},onExportExcel:async function(t){debugger;var g=[];var s=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--mainhbox1");let n=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--projectvalue").getText();let r=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--itemstable1");let a=[];debugger;for(let e=0;e<r.getItems().length;e++){a.push({mta_no:e+1,item_desc:r.getItems()[e].getCells()[0].getText(),tag_no:r.getItems()[e].getCells()[1].getText(),types_of_vessel:r.getItems()[e].getCells()[2].getText(),cap_each:r.getItems()[e].getCells()[3].getText(),dia:r.getItems()[e].getCells()[4].getText(),tl_tl:r.getItems()[e].getCells()[5].getText(),moc:r.getItems()[e].getCells()[6].getText(),dpb:r.getItems()[e].getCells()[7].getText(),weights:r.getItems()[e].getCells()[8].getText(),quantity:r.getItems()[e].getCells()[9].getText()})}var g=[{1:"Commercial Bid Evaluation"},{1:"",2:"",11:"Supplier"},{1:"",2:"",11:"Location"},{1:"Project",2:n,9:" ",11:"Qtn. Ref."},{1:"",2:"",11:"Date"},{1:"",2:"",11:"Validity"},{1:"",2:"",6:"Cylindrical Data"},{1:"MTO Sr.NO ",2:"Items Description",3:"Tag No",4:"Type of Vessel",5:"Capacity Each ( Cu Mtr )",6:"Dia mm",7:"TL to TL Length (mm)",8:"MOC",9:"Design Pressure bar",10:"Weights",11:"Quantity"}];for(let e=0;e<a.length;e++){g.push({1:a[e].mta_no,2:a[e].item_desc,3:a[e].tag_no,4:a[e].types_of_vessel,5:a[e].cap_each,6:a[e].dia,7:a[e].tl_tl,8:a[e].moc,9:a[e].dpb,10:a[e].weights,11:a[e].quantity})}var l=[{1:"",2:""},{1:"3",11:"Spares for 2 Years operation"},{1:" ",11:"Grand Total"},{1:"4",11:"Freight"},{1:"5",11:"Inspection / Testing Charges"},{1:"B.3",11:"Documentation Charges"},{1:"C",11:"RNOD"},{1:"D.1",11:"Custom Duty & Cess"},{1:"D.2",11:"Tax"},{1:"D.6",11:"Shipment charges from EXW to ISRO Mahendragiri"},{1:"D",11:"Total Basic Price including packing, marking & forwarding, Transportation including Taxes"},{11:"Total Basic Price including packing, marking & forwarding, Transportation excluding Taxes"},{1:"F",11:"Per Diem rate for Supervision for Erection and commissioning"},{1:"G.3",11:"Scope and Responsibilities"},{1:"G.4",11:"Commercial Terms"},{1:"G.5",11:"Compliance Terms"},{1:"G.6",11:"Others"},{1:"G.9",11:"Contact person"},{1:"G.10",11:"Contact No"},{1:"G.11",11:"Order can be given to .."},{1:"G.12",11:"Technical approved"},{1:"G.13",11:"Approved vendor"}];debugger;var i=g.concat(l);var m=[];var c=s.getItems()[1].getContent()[0].getItems();let p=[];let u=[];let d=12;for(let e=0;e<c.length;e++){let t=c[e].getItems()[0].getItems()[0].getText();let g=c[e].getItems()[0].getItems()[1].getText();let s=c[e].getItems()[1].getItems();let o=[];p=[{[d]:""},{[d]:t},{[d]:g}];let n=[];let r=c[e].getItems()[2].getItems()[1].getItems();for(let e=0;e<s.length;e++){let t=s[e].getItems()[0].getItems()[0].getText();let g=s[e].getItems()[0].getItems()[1].getText();let o=s[e].getItems()[0].getItems()[2].getText();let l=s[e].getItems()[1].getItems()[0].getText();let i=d;let m=d+1;let c=d+2;d=d+3;let p=[{[i]:t},{[i]:g},{[i]:o},{[m]:l},{[i]:"Unit Rate",[m]:"Rate per unit",[c]:"Total Amount"}];for(let t=0;t<a.length;t++){p.push({[i]:s[e].getItems()[1].getItems()[1].getItems()[t].getCells()[0].getText(),[m]:s[e].getItems()[1].getItems()[1].getItems()[t].getCells()[1].getText(),[c]:s[e].getItems()[1].getItems()[1].getItems()[t].getCells()[2].getText()})}let u=s[e].getItems()[1].getItems()[1].getItems();let I=a.length;let x=[{[i]:""},{[c]:u[I+1].getCells()[2].getText()},{[c]:u[I+2].getCells()[2].getText()},{[i]:u[I+3].getCells()[0].getText(),[c]:u[I+3].getCells()[2].getText()},{[i]:u[I+4].getCells()[0].getText(),[c]:u[I+4].getCells()[2].getText()},{[i]:u[I+5].getCells()[0].getText(),[c]:u[I+5].getCells()[2].getText()},{[c]:u[I+6].getCells()[2].getText()},{[c]:u[I+7].getCells()[2].getText()},{[i]:u[I+8].getContent()[0].getText()},{[i]:u[I+9].getCells()[0].getText()},{[c]:u[I+10].getCells()[2].getText()},{[c]:u[I+11].getCells()[2].getText()},{[c]:u[I+12].getCells()[2].getText()},{[i]:r[e].getItems()[0].getContent()[0].getText()},{[i]:r[e].getItems()[1].getContent()[0].getText()},{[i]:r[e].getItems()[2].getContent()[0].getText()},{[i]:r[e].getItems()[3].getContent()[0].getText()},{[i]:r[e].getItems()[4].getText()},{[i]:r[e].getItems()[5].getText()},{[i]:r[e].getItems()[6].getText()},{[i]:r[e].getItems()[7].getText()},{[i]:r[e].getItems()[8].getText()}];p=p.concat(x);n.push(p)}const l=n.map(e=>e.length);const i=l.every((e,t,g)=>e===g[0]);let m=[];if(i){for(let e=0;e<n[0].length;e++){let t={};for(let g=0;g<n.length;g++){Object.assign(t,n[g][e])}m.push(t)}console.log(m)}else{console.log("Arrays in updatarr have different lengths. Unable to merge.")}p=p.concat(m);u.push(p)}let I=[];const x=u.map(e=>e.length);const f=x.every((e,t,g)=>e===g[0]);if(f){for(let e=0;e<u[0].length;e++){let t={};for(let g=0;g<u.length;g++){Object.assign(t,u[g][e])}I.push(t)}console.log(I)}else{console.log("Arrays in updatarr have different lengths. Unable to merge.")}console.log(I);let T=[];if(i.length===I.length){for(let e=0;e<i.length;e++){let t=Object.assign({},i[e],I[e]);T.push(t)}console.log(T)}else{console.log("Arrays have different lengths. Unable to merge.")}let h=[];for(let e=0;e<d;e++){if(d==1){h.push({label:` `,property:`${e+1}`,type:o.String,width:"100"})}else{h.push({label:` `,property:`${e+1}`,type:o.String})}}debugger;debugger;var C=new sap.ui.export.Spreadsheet({workbook:{columns:h,context:{application:"SAP UI5 Export Sample",author:"Sample"},hierarchyLevel:"level"},dataSource:T,fileName:"cbe_comp.xlsx"});C.build().then(function(){e.show("Exported successfully!")}).catch(function(t){e.show("Export failed: "+t)})}}});