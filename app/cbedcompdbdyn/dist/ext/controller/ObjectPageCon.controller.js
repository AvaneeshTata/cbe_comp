sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageToast"],function(e,t){"use strict";return e.extend("cbedcompdbdyn.ext.controller.ObjectPageCon",{override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},routing:{onAfterBinding:async function(e){try{function se(){var e=Math.floor(Math.random()*1e6);var t=(new Date).getTime();var a=t+"-"+e;return a}var a=e.sPath;var s=a.match(/'([^']+)'/);sap.ui.core.BusyIndicator.show();var n=this.base.getAppComponent().getManifestObject()._oBaseUri._string;if(n){var l={url:n+"odata/v4/catalogcbeservice/Project_Details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}else{var l={url:"/odata/v4/catalogcbeservice/Project_Details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}var o;await $.ajax(l).done(async(e,t,a)=>{o=e.value}).fail(e=>{console.log(e);t.show(e)});if(n){var l={url:n+"odata/v4/catalogcbeservice/Item_details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}else{var l={url:"/odata/v4/catalogcbeservice/Item_details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}var d;await $.ajax(l).done(async(e,t,a)=>{d=e.value}).fail(e=>{console.log(e);t.show(e)});if(n){var l={url:n+"odata/v4/catalogcbeservice/Vendor_details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}else{var l={url:"/odata/v4/catalogcbeservice/Vendor_details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}var r;await $.ajax(l).done(async(e,t,a)=>{r=e.value}).fail(e=>{console.log(e)});if(n){var l={url:n+"odata/v4/catalogcbeservice/PAN_Info",method:"GET"}}else{var l={url:"/odata/v4/catalogcbeservice/PAN_Info",method:"GET"}}var i;await $.ajax(l).done(async(e,t,a)=>{i=e.value}).fail(e=>{console.log(e)});if(n){var l={url:n+"odata/v4/catalogcbeservice/PAN_vendor_reponse_details",method:"GET"}}else{var l={url:"/odata/v4/catalogcbeservice/PAN_vendor_reponse_details",method:"GET"}}var m;await $.ajax(l).done(async(e,t,a)=>{m=e.value}).fail(e=>{console.log(e)});var c=this.getView().getContent()[0].getSections()[0].mAggregations._grid.getContent()[0].mAggregations._grid.getContent()[0].getContent();let ne=c.getItems()[0].getItems()[2].getItems()[0].getColumns();for(let ce=0;ce<ne.length;ce++){ne[ce].setStyleClass("custcolorclass")}c.getItems()[0].getItems()[0].getItems()[0].getItems()[0].getItems()[0].setVisible(false);c.getItems()[0].getItems()[0].getItems()[0].getItems()[1].getItems()[1].setText(`${" "+o[0]?.Project_Description??" "}`);c.getItems()[0].getItems()[0].getItems()[0].getItems()[1].getItems()[1].setTextAlign("End");c.getItems()[0].getItems()[0].getItems()[0].getItems()[2].getItems()[0].setVisible(false);var p=c.getItems()[0].getItems()[2].getItems()[0];var g=c.getItems()[0].getItems()[1].getItems()[0];if(!g.getItems()[1]){g.addItem(new sap.ui.core.Icon(`${"cylindricaldtaicon"+se()}`,{src:"sap-icon://expand",color:"darkblue",hoverColor:"red",activeColor:"darkgreen",size:"12px",width:"20px",press:function(e){var t=c.getItems()[0];let a=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--total_basic_pricing");let s;let n=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--newItemID1");let l;if(t.getWidth()=="30%"){p.setFixedLayout(false);t.setWidth("80%");e.getSource().setSrc("sap-icon://collapse")}else{p.setFixedLayout(true);t.setWidth("30%");e.getSource().setSrc("sap-icon://expand")}}}))}p.destroyItems();const le=new Set;const oe=[];d.forEach(e=>{if(!le.has(e.Item_Code)){le.add(e.Item_Code);oe.push(e)}});for(let pe=0;pe<oe.length;pe++){p.addItem(new sap.m.ColumnListItem(`${"collistitem"+(pe+1)}`));let ge=p.getItems()[pe];let xe=new sap.m.Text(`${"itemdesc"+(pe+1)}`,{text:`${d[pe]?.Item_Short_Description??" "}`,tooltip:`${d[pe]?.Item_Short_Description??" "}`,wrapping:false});ge.addCell(xe);let Ie=new sap.m.Text(`${"tag_no"+(pe+1)}`,{text:`${d[pe]?.tag_no??" "}`,tooltip:`${d[pe]?.tag_no??" "}`,wrapping:false});ge.addCell(Ie);let we=new sap.m.Text(`${"types_of_vessel"+(pe+1)}`,{text:`${d[pe]?.types_of_vessel??" "}`,tooltip:`${d[pe]?.types_of_vessel??" "}`,wrapping:false});ge.addCell(we);let ue=new sap.m.Text(`${"capacity_each_in_cu_mtr"+(pe+1)}`,{text:`${d[pe]?.capactity_each??" "}`,tooltip:`${d[pe]?.capactity_each??" "}`,wrapping:false});ge.addCell(ue);let $e=new sap.m.Text(`${"dia_in_mm"+(pe+1)}`,{text:`${d[pe]?.dia??" "}`,tooltip:`${d[pe]?.dia??" "}`,wrapping:false});ge.addCell($e);let _e=new sap.m.Text(`${"tl_to_tl_len"+(pe+1)}`,{text:`${d[pe]?.tl_tl_len??" "}`,tooltip:`${d[pe]?.tl_tl_len??" "}`,wrapping:false});ge.addCell(_e);let ve=new sap.m.Text(`${"moc"+(pe+1)}`,{text:`${d[pe]?.moc??" "}`,tooltip:`${d[pe]?.moc??" "}`,wrapping:false});ge.addCell(ve);let be=new sap.m.Text(`${"design_pressure_bar"+(pe+1)}`,{text:`${d[pe]?.design_pb??" "}`,tooltip:`${d[pe]?.design_pb??" "}`,wrapping:false});ge.addCell(be);let fe=new sap.m.Text(`${"weights_in_kg"+(pe+1)}`,{text:`${d[pe]?.weights??" "}`,tooltip:`${d[pe]?.weights??" "}`,wrapping:false});ge.addCell(fe);let Ce=new sap.m.Text(`${"qty_no"+(pe+1)}`,{text:`${d[pe]?.Quantity??" "}`,tooltip:`${d[pe]?.Quantity??" "}`,wrapping:false});ge.addCell(Ce)}var x=c.getItems()[1].getContent()[0];x.destroyItems();if(n){var l={url:n+"odata/v4/catalogcbeservice/Vendor_details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}else{var l={url:"/odata/v4/catalogcbeservice/Vendor_details?$filter=ProjectId eq "+`'${s[1]}'`,method:"GET"}}var I;await $.ajax(l).done(async(e,t,a)=>{I=e.value}).fail(e=>{console.log(e)});let de=new Set;let re=0;for(let Te=0;Te<I.length;Te++){const he=I[Te].vendor_code;if(de.has(he)){continue}de.add(he);x.addItem(new sap.m.VBox(`${"sectionvbox"+(Te+1)}`));let ye=x.getItems()[re];re++;ye.addStyleClass("BorderClass");ye.addItem(new sap.m.VBox(`${"vboxsuppnameloc"+(Te+1)}`));ye.addItem(new sap.m.HBox(`${"hbmiddlesection"+(Te+1)}`));ye.addItem(new sap.m.VBox(`${"vbox_last_section"+(Te+1)}`));var w=ye.getItems()[2];w.setVisible(false);var u=new sap.m.ComboBox(`${"combobox"+(Te+1)}`,{change:function(e){for(let t=0;t<e.getSource().getParent().getItems()[1].getItems().length;t++){if(e.getSource().getItems()[t].getText()==e.getSource().getValue()){e.getSource().getParent().getItems()[1].getItems()[t].setVisible(true)}else{e.getSource().getParent().getItems()[1].getItems()[t].setVisible(false)}}}});w.addItem(u);var _=new sap.m.HBox(`${"hboxcombo"+(Te+1)}`);w.addItem(_);var v=w.getItems()[1];let Se=ye.getItems()[0];Se.addStyleClass("alignmentVendorClass");Se.addItem(new sap.m.Title(`${"SupplierName"+(Te+1)}`,{text:`${I[Te].Vendor_Name?I[Te].Vendor_Name:" "}`}));Se.getItems()[0].addStyleClass("titleStyleClass");Se.addItem(new sap.m.Title(`${"SupplierLocation"+(Te+1)}`,{text:`${I[Te].Vendor_Location?I[Te].Vendor_Location:" "}`}));Se.getItems()[1].addStyleClass("titleStyleClass");Se.addStyleClass("v11spaceBetweenclass");var b=ye.getItems()[1];b.addStyleClass("alignmentVendorClass");let Pe=0;let Ve=0;do{if(I[Pe].ProjectId==s[1]&&I[Pe].Proposed_Vendor_Code==I[Te].Proposed_Vendor_Code){b.addItem(new sap.m.VBox(`${"vbmiddlesection"+se()}`,{}));var f=b.getItems().length;var C=b.getItems()[f-1];C.addStyleClass("customVBox");C.addItem(new sap.m.VBox(`${"vbmiddlesection_innervb"+se()}`));var T=C.getItems()[0];T.addItem(new sap.m.Text(`${"org_qtn_ref"+se()}`,{text:`${I[Pe]?.qtn_ref??"NA"}`}));T.addItem(new sap.m.Text(`${"org_date"+se()}`,{text:`${I[Pe]?.date??"NA"}`}));T.addItem(new sap.m.Text(`${"org_validity"+se()}`,{text:`${I[Pe]?.validity??"NA"}`}));T.addItem(new sap.m.Text(`${"org_cylindrical_space"+se()}`,{text:""}));T.addStyleClass("vbmiddlesectionclass");var h=new sap.m.VBox(`${"innervbox"+se()}`,{});C.addItem(h);let Be=i.find(e=>e.PAN_Number===I[Pe].PAN_Number);h.addItem(new sap.m.Label(`${"original_offer"+se()}`,{text:`${Be?.status_a??" "}`,design:"Bold"}));var y=new sap.m.Table({id:`${"offer"+se()}`,class:"tableBorder",growing:true,growingThreshold:20,width:"350px",fixedLayout:true});y.addStyleClass("tableBorder");h.addItem(y);var S=new sap.m.Column({id:`${"unit_rate"+se()}`,header:new sap.m.Label({text:"Unit Rate",design:"Bold",wrapping:false}),styleClass:"custcolorclass"});var P=new sap.m.Column({id:`${"unit_rate_per"+se()}`,header:new sap.m.Label({text:"Rate per Unit",design:"Bold",wrapping:false}),styleClass:"custcolorclass"});var V=new sap.m.Column({id:`${"total_amt_offer"+se()}`,header:new sap.m.HBox,styleClass:"custcolorclass"});y.addColumn(S);y.addColumn(P);y.addColumn(V);var L=y.getColumns()[2].getHeader();L.addItem(new sap.m.Label({text:"Total Amount",design:"Bold"}));var B=[];var N=0;var j="";let Ne=0;let je=new Set;const Ae=d.filter(e=>e.PAN_Number===I[Pe].PAN_Number&&e.Proposed_Vendor_Code===I[Pe].Proposed_Vendor_Code);for(let Oe=0;Oe<oe.length;Oe++){const Qe=oe[Oe];const We=Ae.find(e=>e.Item_Code===Qe.Item_Code);if(We){var A=We.Amount.replace(/,/g,"")??0;var E=We.Quantity.replace(/,/g,"")??0;const ze=Number(A??0)*Number(E??0);const Re=`${ze} ${We.Unit_Price??" "}`;N+=ze;j=We.Unit_Price;const Je=new sap.m.ColumnListItem({id:`${"item1data"+se()}`,cells:[new sap.m.Text({text:`${A??" "} ${We.Unit_Price}`}),new sap.m.Text({text:`${We.unit_rate_per_unit??" "}`}),new sap.m.Text({text:Re})]});y.addItem(Je)}else{const Ke=new sap.m.ColumnListItem({id:`${"item1data"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(Ke)}}const Ee=m.filter(e=>e.PAN_Number===I[Pe].PAN_Number&&e.Proposed_Vendor_Code===I[Pe].Proposed_Vendor_Code);var q=new sap.m.ColumnListItem({id:`${"blankspace"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(q);var G=new sap.m.ColumnListItem({id:`${"spare"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Text({text:`${I[Pe]?.spares_for_2_years??" "}`})]});y.addItem(G);var k=new sap.m.ColumnListItem({id:`${"grandtotal"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Label({text:`${N+" "+j}`,design:"Bold"})]});y.addItem(k);var D=new sap.m.ColumnListItem({id:`${"parkingmarking"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.packing_marking_forwarding??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(D);var H=new sap.m.ColumnListItem({id:`${"inspection"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.inspection_testing_charges??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(H);var M=new sap.m.ColumnListItem({id:`${"documentation"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.documentation_charges??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(M);var U=new sap.m.ColumnListItem({id:`${"totalbasicpricing"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Label({text:`${N+" "+j}`,design:"Bold"})]});y.addItem(U);var F=new sap.m.ColumnListItem({id:`${"rnod"+se()}`,cells:[new sap.m.Label({text:`${I[Pe]?.rnod??" "}`,design:"Bold"}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(F);var O=new sap.m.ColumnListItem({id:`${"customduty"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.custom_duty_cess??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(O);var Q=new sap.m.ColumnListItem({id:`${"sgst"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.sgst??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(Q);var W=new sap.m.ColumnListItem({id:`${"igst"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.igst??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:`${Number(I[Pe]?.igst??" ")*Number(I[Pe]?.total_basic_price_including_packing??" ")/100}`})]});y.addItem(W);var z=new sap.m.ColumnListItem({id:`${"ugst"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.ugst??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:`${Number(I[Pe]?.ugst??" ")*Number(I[Pe]?.total_basic_price_including_packing??" ")/100}`})]});y.addItem(z);var R=new sap.m.ColumnListItem({id:`${"shipment"+se()}`,visible:false,cells:[new sap.m.Text({text:`${I[Pe]?.shipment_charges??" "}`}),new sap.m.Text({text:""}),new sap.m.Text({text:""})]});y.addItem(R);var J=new sap.m.ColumnListItem({id:`${"totalincludingtaxes"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Label({text:`${N+" "+j}`,design:"Bold"})]});y.addItem(J);var J=new sap.m.ColumnListItem({id:`${"total_excluding_taxes"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Label({text:`${N+" "+j}`,design:"Bold"})]});y.addItem(J);var K=new sap.m.ColumnListItem({id:`${"perdiemrate"+se()}`,cells:[new sap.m.Text({text:""}),new sap.m.Text({text:""}),new sap.m.Text({text:`${I[Pe]?.per_diem_rate_for_supervision??" "}`})]});y.addItem(K);var X=w.getItems()[0];var Y=new sap.ui.core.Item(`${"item1"+se()}`,{text:`${Be?.status_a??" "}`});X.addItem(Y);X.setValue(`${Be?.status_a??""}`);v.addItem(new sap.m.VBox(`${"offer"+se()}`));var Z=v.getItems()[Ve];Ve++;Z.addStyleClass("spacebetweenclass");Z.addItem(new sap.m.Text(`${"pricebasis"+se()}`,{text:`${I[Pe]?.PriceBasis??" "}`}));Z.getItems()[0].addStyleClass("pricebasispadding");Z.addItem(new sap.m.Text(`${"pointofdelivery"+se()}`,{text:`${I[Pe]?.point_of_delivery??" "}`}));Z.addItem(new sap.m.ScrollContainer(`${"deliveryperiodScroll"+se()}`,{vertical:true,height:"100px"}));Z.getItems()[1].addStyleClass("deliveryperiodpadding");Z.getItems()[2].addContent(new sap.m.Text(`${"deliveryperiod"+se()}`,{text:`${I[Pe]?.delivery_period??" "}`}));Z.addItem(new sap.m.ScrollContainer(`${"paymenttermsScroll"+se()}`,{vertical:true,height:"100px"}));Z.getItems()[3].addContent(new sap.m.Text(`${"paymentterms"+se()}`,{text:`${I[Pe]?.payment_terms??" "}`}));Z.addItem(new sap.m.ScrollContainer(`${"liquidedScroll"+se()}`,{vertical:true,height:"100px"}));Z.getItems()[4].addContent(new sap.m.Text(`${"liquided"+se()}`,{text:`${I[Pe]?.liquidated_damages??" "}`}));Z.addItem(new sap.m.ScrollContainer(`${"warrantyScroll"+se()}`,{vertical:true,height:"100px"}));Z.getItems()[5].addContent(new sap.m.Text(`${"warranty"+se()}`,{text:`${I[Pe]?.warranty_defect_liability_period??" "}`}));Z.addItem(new sap.m.ScrollContainer(`${"cpbgScroll"+se()}`,{vertical:true,height:"100px"}));Z.getItems()[6].addContent(new sap.m.Text(`${"cpbg"+se()}`,{text:`${Ee[0]?.CPBG??" "}`}));const qe=Ee[0]?.Vendor_Contact_PersonDASH1??"";if(qe){var ee=/name\s*:(.*?)\s*email/;var te=qe.match(ee)}var ae=te?te[1].trim():null;Z.addItem(new sap.m.Text(`${"contactperson"+se()}`,{text:`${ae??" "}`}));const Ge=/ph1\s*:\s*(.*?)\s*ph2/;const ke=qe.match(Ge);const De=ke?ke[1].trim():null;const He=/ph2\s*:\s*(.*?)$/;const Me=qe.match(He);const Ue=Me?Me[1].trim():null;Z.addItem(new sap.m.Text(`${"contactno"+se()}`,{text:`${De+", "+Ue??" "}`}));Z.addItem(new sap.m.Text(`${"ordercanbe"+se()}`,{text:`${I[Pe]?.order_given_to??" "}`}));Z.addItem(new sap.m.Text(`${"technicallyapproved"+se()}`,{text:`${I[Pe]?.Technically_Approved??" "}`}));Z.addItem(new sap.m.Text(`${"approvedvendor"+se()}`,{text:`${I[Pe]?.approved_vendor??" "}`}));let Fe=Z.getItems()[Z.getItems().length-1];Fe.addStyleClass("customlaststyleclassrsection")}Pe++}while(Pe<I.length);for(let Xe=0;Xe<b.getItems().length-1;Xe++){b.getItems()[Xe].setVisible(false);b.getParent().getItems()[2].getItems()[1].getItems()[Xe].setVisible(false)}let Le=b.getItems()[b.getItems().length-1];Le.getItems()[1].getItems()[1].getColumns()[2].getHeader().addItem(new sap.ui.core.Icon(`${"total_amount_icon"+se()}`,{src:"sap-icon://expand",color:"darkblue",hoverColor:"red",activeColor:"darkgreen",size:"12px",width:"20px",press:function(e){var a=e.getSource().getParent().getParent().getParent().getParent().getParent().getParent().getItems();if(a.length==1){t.show("No More Status")}else{for(let t=0;t<a.length-1;t++){if(a[t].getVisible()==true){a[t].setVisible(false);e.getSource().setSrc("sap-icon://expand")}else{a[t].setVisible(true);e.getSource().setSrc("sap-icon://collapse")}}}}}))}let ie=sap.ui.getCore().byId("cbedcompdbdyn::Project_DetailsObjectPage--fe::CustomSubSection::Fragment--rightHboxcontainer");debugger;let me=ie.getItems()[ie.getItems().length-1];sap.ui.core.BusyIndicator.hide()}catch(Ye){t.show(Ye)}}}}})});